#nuovo file per pacchetti mappa
install.packages(c("cowplot","googleway","ggplot2","ggrepel","ggrepel","ggspatial",
                   "libwgeom","sf","rnaturalearth","rnaturalearthdata"))
library("ggplot2")
theme_set(theme_bw())
library("sf")

library("rnaturalearth")
library("rnaturalearthdata")

install.packages("rgeos")
library("rgeos")
world<-ne_countries(scale="medium",returnclass="sf")
class(world)

ggplot(data=world)+geom_sf()

ggplot(data=world)+geom_sf(aes(fill=V60))+scale_fill_viridis_c(option="plasma")

gdp_capita<-gdp_capita[-1,]
rownames(gdp_capita)<-c(0:263)

gdp_capita<-gdp_capita[,-(2:58)]
gdp_capita<-gdp_capita[,-2]
a<-c(0:240)

#Creo un vettore ordinato con tutti i dati in base al dataset "world" del Pil pro capite
b<-c(27980.8807,578.4664,4166.9797,NA,3952.8012,NA,35762.5231,38663.3838,13789.0604,3607.2967,
     11843.3312,NA,NA,NA,14286.0932,56755.7217,44178.0474,5500.3104,305.5498,40991.8081,1076.7977,
     653.3270,1248.4534,7055.9357,22634.1186,31295.0621,4727.2777,NA,5949.1063,4775.9556,102005.6256,
     3035.9722,8814.0010,16525.0733,31164.5620,2752.6642,6799.8702,377.4230,43585.5120,82081.5972,
     13574.1718,8066.9426,1972.5461,1327.5030,497.3170,2461.4942,NA,6175.8760,1242.6032,3043.0140,
     11299.1355,7694.0119,19951.3279,76280.4866,NA,23333.7149,17829.6983,41086.7297,2658.9788,7596.4351,
     53254.8564,6921.5172,4187.5097,6124.4916,3562.9327,NA,25732.0184,17522.2302,640.5419,42784.6984,
     5390.7453,NA,36638.1849,52404.6593,2906.3768,7384.7159,44974.831,4014.1859,NA,1743.8510,769.2560,
     660.7236,603.4011,11283.4656,18167.7737,9096.8706,44536.4013,3994.6369,35278.9259,5576.8333,
     42431.8883,NA,2302.2014,11781.7348,1389.1195,12706.8912,3331.6951,85124.9250,1605.6054,NA,
     NA,61995.4228,4904.3269,4989.8031,52564.4292,35776.7952,30230.2263,4907.5037,NA,4164.1079,34524.4699,
     NA,10510.7719,1336.8833,1121.0828,1162.9049,1542.5752,18028.9734,28732.2311,NA,29869.5294,2134.7118,
     7644.5487,710.3839,4337.9191,10093.8998,167290.9400,3843.7807,1152.1398,14258.2293,101376.4966,
     13774.6053,75340.9870,NA,2875.2580,166011.5091,2732.4571,467.2354,9033.4399,9616.6450,3213.8373,
     4840.2731,751.4748,24921.6036,1287.4305,6514.5692,3918.5792,16690.5701,589.859,1524.0729,NA,9260.4473,
     380.5970,9955.2437,4869.3784,NA,484.2386,NA,2687.4801,2049.8497,NA,45175.2319,74355.5159,792.5529,
     6956.2538,38615.9952,16028.6115,1356.6678,13630.3080,NA,6229.1017,3001.0404,15876.4619,2679.3456,
     12578.4955,29763.4883,NA,19242.3665,5406.703,3272.1543,NA,63039.0635,8969.1489,9313.0136,751.6394,
     NA,20627.9328,1909.7388,NA,1219.2487,55646.6187,NA,NA,2167.1738,588.2285,3705.5779,42660.3382,
     NA,NA,NA,5588.9807,1584.8278,8562.0814,16310.9884,20881.7669,51545.4836,NA,32274.8906,14745.3415,
     NA,26182.4296,776.0195,570.9103,5840.0465,929.0959,6432.6807,1332.7829,4336.1966,18289.7043,3861.6885,
     11006.2497,NA,947.9334,843.6294,2124.6623,15613.7643,56839.3818,2615.0251,NA,6920.8781,NA,NA,34797.1405,
     2085.1015,2801.9398,NA,4073.6660,1602.0378,5734.6336,1337.7956,1445.0711)

world[[65]]=b
world<-world[,-65]

#Stesso vettore di prima ma con il LIechtestein come NA
d<-c(27980.8807,578.4664,4166.9797,NA,3952.8012,NA,35762.5231,38663.3838,13789.0604,3607.2967,
     11843.3312,NA,NA,NA,14286.0932,56755.7217,44178.0474,5500.3104,305.5498,40991.8081,1076.7977,
     653.3270,1248.4534,7055.9357,22634.1186,31295.0621,4727.2777,NA,5949.1063,4775.9556,102005.6256,
     3035.9722,8814.0010,16525.0733,31164.5620,2752.6642,6799.8702,377.4230,43585.5120,82081.5972,
     13574.1718,8066.9426,1972.5461,1327.5030,497.3170,2461.4942,NA,6175.8760,1242.6032,3043.0140,
     11299.1355,7694.0119,19951.3279,76280.4866,NA,23333.7149,17829.6983,41086.7297,2658.9788,7596.4351,
     53254.8564,6921.5172,4187.5097,6124.4916,3562.9327,NA,25732.0184,17522.2302,640.5419,42784.6984,
     5390.7453,NA,36638.1849,52404.6593,2906.3768,7384.7159,44974.831,4014.1859,NA,1743.8510,769.2560,
     660.7236,603.4011,11283.4656,18167.7737,9096.8706,44536.4013,3994.6369,35278.9259,5576.8333,
     42431.8883,NA,2302.2014,11781.7348,1389.1195,12706.8912,3331.6951,85124.9250,1605.6054,NA,
     NA,61995.4228,4904.3269,4989.8031,52564.4292,35776.7952,30230.2263,4907.5037,NA,4164.1079,34524.4699,
     NA,10510.7719,1336.8833,1121.0828,1162.9049,1542.5752,18028.9734,28732.2311,NA,29869.5294,2134.7118,
     7644.5487,710.3839,4337.9191,10093.8998,NA,3843.7807,1152.1398,14258.2293,101376.4966,
     13774.6053,75340.9870,NA,2875.2580,166011.5091,2732.4571,467.2354,9033.4399,9616.6450,3213.8373,
     4840.2731,751.4748,24921.6036,1287.4305,6514.5692,3918.5792,16690.5701,589.859,1524.0729,NA,9260.4473,
     380.5970,9955.2437,4869.3784,NA,484.2386,NA,2687.4801,2049.8497,NA,45175.2319,74355.5159,792.5529,
     6956.2538,38615.9952,16028.6115,1356.6678,13630.3080,NA,6229.1017,3001.0404,15876.4619,2679.3456,
     12578.4955,29763.4883,NA,19242.3665,5406.703,3272.1543,NA,63039.0635,8969.1489,9313.0136,751.6394,
     NA,20627.9328,1909.7388,NA,1219.2487,55646.6187,NA,NA,2167.1738,588.2285,3705.5779,42660.3382,
     NA,NA,NA,5588.9807,1584.8278,8562.0814,16310.9884,20881.7669,51545.4836,NA,32274.8906,14745.3415,
     NA,26182.4296,776.0195,570.9103,5840.0465,929.0959,6432.6807,1332.7829,4336.1966,18289.7043,3861.6885,
     11006.2497,NA,947.9334,843.6294,2124.6623,15613.7643,56839.3818,2615.0251,NA,6920.8781,NA,NA,34797.1405,
     2085.1015,2801.9398,NA,4073.6660,1602.0378,5734.6336,1337.7956,1445.0711)

world[[66]]=d

colnames(world)[65]<-"Pil_pro_capite"

#Grafico con Liechtenstein come NA
ggplot(data=world)+geom_sf(aes(fill=V66))+
        scale_fill_viridis_c(option="plasma")+ggtitle("Pil pro capite nel mondo")
#non cambia quasi nulla

#dividiamo in due lo schermo
par(mfrow=c(1,2))

#Grafico con tutti i dati
#direi di usare questo grafico tanto a livello visivo non cambia nulla
ggplot(data=world)+geom_sf(aes(fill=Pil_pro_capite))+
        scale_fill_viridis_c(option="plasma")+
        ggtitle("Pil pro capite nel mondo",subtitle="(241 Paesi)")

#Grafico riferito all'Europa
ggplot(data=world)+geom_sf(aes(fill=Pil_pro_capite))+
        scale_fill_viridis_c(option="plasma")+
        ggtitle("Pil pro capite in Europa")+coord_sf(xlim=c(-25,59),ylim=c(35,71),expand=FALSE)
